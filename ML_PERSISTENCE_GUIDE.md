# üß† ML Model Persistence - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### –ü—Ä–æ–±–ª–µ–º—ã (–¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):
- ‚ùå ML –º–æ–¥–µ–ª–∏ –ù–ï —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –º–µ–∂–¥—É –∑–∞–ø—É—Å–∫–∞–º–∏
- ‚ùå –ö–∞–∂–¥—ã–π —Ä–∞–∑ –Ω–∞—á–∏–Ω–∞–ª–∏ —Å 0/50 samples (—Ö–æ–ª–æ–¥–Ω—ã–π —Å—Ç–∞—Ä—Ç)
- ‚ùå TensorFlow –Ω–µ –±—ã–ª —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (LSTM –Ω–µ —Ä–∞–±–æ—Ç–∞–ª)
- ‚ùå –ü—Ä–∏ –∞–≤–∞—Ä–∏–π–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ—Ä—è–ª–∏—Å—å

### –†–µ—à–µ–Ω–∏–µ (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è):
- ‚úÖ –ú–æ–¥–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 10 —Å–¥–µ–ª–æ–∫
- ‚úÖ –ú–æ–¥–µ–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- ‚úÖ TensorFlow 2.20.0 —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–µ–Ω

---

## üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞:
```
üß† [ML_LOAD] Loading historical data...
‚úÖ [ML_LOAD] Loaded model 'pnl_predictor': 150 samples seen
‚úÖ [ML_LOAD] Loaded model 'win_probability': 150 samples seen
‚úÖ [ML_LOAD] Loaded model 'hold_time_predictor': 150 samples seen
‚úÖ [ML_LOAD] Loaded model 'risk_estimator': 150 samples seen
üß† [ML_LOAD] Successfully loaded 4/4 ML models
```

### 2. –í–æ –≤—Ä–µ–º—è —Ç–æ—Ä–≥–æ–≤–ª–∏:
```
üß† [ML_LEARNING] Learned from BTCUSDT: +0.75% PnL in 25.3 min
üìö [ML_SAMPLES] 151/200 samples collected for ML training

# –ö–∞–∂–¥—ã–µ 10 —Å–¥–µ–ª–æ–∫:
üíæ [AUTO_SAVE] Saving ML models at 160 samples...
‚úÖ [AUTO_SAVE] ML models saved successfully
```

### 3. –ü—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –±–æ—Ç–∞ (Ctrl+C):
```
üõë [SHUTDOWN] Stopping trading engine...
üíæ [SHUTDOWN] Saving ML models and learning data...
‚úÖ [SHUTDOWN] ML models saved (160 samples trained)
‚úÖ [SHUTDOWN] Trading engine stopped cleanly
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `ml_learning_data/`:
```
ml_learning_data/
‚îú‚îÄ‚îÄ pnl_predictor_model.pkl          # –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è PnL
‚îú‚îÄ‚îÄ pnl_predictor_scaler.pkl         # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ pnl_predictor_metadata.json      # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (samples_seen, timestamp)
‚îÇ
‚îú‚îÄ‚îÄ win_probability_model.pkl        # –ú–æ–¥–µ–ª—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –≤—ã–∏–≥—Ä—ã—à–∞
‚îú‚îÄ‚îÄ win_probability_scaler.pkl
‚îú‚îÄ‚îÄ win_probability_metadata.json
‚îÇ
‚îú‚îÄ‚îÄ hold_time_predictor_model.pkl    # –ú–æ–¥–µ–ª—å –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
‚îú‚îÄ‚îÄ hold_time_predictor_scaler.pkl
‚îú‚îÄ‚îÄ hold_time_predictor_metadata.json
‚îÇ
‚îú‚îÄ‚îÄ risk_estimator_model.pkl         # –ú–æ–¥–µ–ª—å –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–æ–≤
‚îú‚îÄ‚îÄ risk_estimator_scaler.pkl
‚îú‚îÄ‚îÄ risk_estimator_metadata.json
‚îÇ
‚îú‚îÄ‚îÄ market_contexts.json             # –ò—Å—Ç–æ—Ä–∏—è —Ä—ã–Ω–æ—á–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
‚îî‚îÄ‚îÄ trade_outcomes.json              # –ò—Å—Ç–æ—Ä–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–¥–µ–ª–æ–∫
```

### –ü—Ä–∏–º–µ—Ä –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (`pnl_predictor_metadata.json`):
```json
{
  "samples_seen": 150,
  "is_fitted": true,
  "saved_at": "2025-11-19T04:25:30.123456+00:00"
}
```

---

## üéØ –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è

### –§–∞–∑—ã –æ–±—É—á–µ–Ω–∏—è:

#### 1. **COLD START** (0-50 samples)
```
üß† [COLD_START] Learning mode: 15/50 samples - ML –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç
```
- ML —Å–∏—Å—Ç–µ–º–∞ —Å–æ–±–∏—Ä–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
- –í—Å–µ —Å–∏–≥–Ω–∞–ª—ã IMBA –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è
- ML —Ç–æ–ª—å–∫–æ –Ω–∞–±–ª—é–¥–∞–µ—Ç –∏ —É—á–∏—Ç—Å—è

#### 2. **LEARNING** (50-200 samples)
```
üéì [LEARNING] Learning mode: 120/200 samples, progress: 46.7%
```
- ML –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –Ω–∞—á–∏–Ω–∞–µ—Ç –≤–ª–∏—è—Ç—å –Ω–∞ —Ä–µ—à–µ–Ω–∏—è
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏: 1.4 ‚Üí 1.1
- –í–µ—Å ML —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è: 0% ‚Üí 30%

#### 3. **FULL ML** (200+ samples)
```
üß† [FULL_ML] Full ML mode: 250 samples
```
- ML –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Ä–µ—à–µ–Ω–∏–π
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ ML –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏:
```bash
python3 test_ml_persistence.py
```

### –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```
‚úÖ SUCCESS! Loaded 60 samples (same as saved 60)
‚úÖ Models are persistent across restarts!
‚úÖ ML MODEL PERSISTENCE TEST COMPLETED SUCCESSFULLY!
```

---

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏:
```bash
ls -lh ml_learning_data/
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—É—á–µ–Ω–Ω—ã—Ö samples:
```bash
cat ml_learning_data/pnl_predictor_metadata.json
```

### –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –º–æ–¥–µ–ª–∏ (–Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ):
```bash
rm -rf ml_learning_data/ enhanced_learning_data/
```

---

## üìà –û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:
- **0-50 samples**: –ë–∞–∑–æ–≤—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, ML —É—á–∏—Ç—Å—è
- **50-200 samples**: –£–ª—É—á—à–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- **200+ samples**: –°—Ç–∞–±–∏–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, –≤—ã—Å–æ–∫–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å

### –ú–µ—Ç—Ä–∏–∫–∏:
- `prediction_confidence`: –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å ML (0.0 ‚Üí 1.0)
- `win_probability`: –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —É—Å–ø–µ—Ö–∞ —Å–¥–µ–ª–∫–∏ (50% ‚Üí 70%+)
- `expected_pnl_pct`: –û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–∏–±—ã–ª—å (-1% ‚Üí +2%)

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –ú–æ–¥–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 10 —Å–¥–µ–ª–æ–∫
2. **Git –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è**: `ml_learning_data/` –≤ `.gitignore` (–Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è)
3. **Backup**: –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞—Ç—å backup `ml_learning_data/`
4. **–û—á–∏—Å—Ç–∫–∞**: –°—Ç–∞—Ä—ã–µ –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤—Ä—É—á–Ω—É—é –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

---

## üöÄ –ß—Ç–æ –¥–∞–ª—å—à–µ

### –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞ –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏:
```bash
# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º
python3 start_bot.py

# –í—ã–±–µ—Ä–∏—Ç–µ:
# 1 - Testnet (–±–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
# 2 - Mainnet (—Ä–µ–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è)
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ ML —Å–∏—Å—Ç–µ–º–∞ –±—É–¥–µ—Ç:
1. ‚úÖ –ó–∞–≥—Ä—É–∂–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
2. ‚úÖ –°–æ–±–∏—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–µ
3. ‚úÖ –û–±—É—á–∞—Ç—å—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
4. ‚úÖ –°–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 10 —Å–¥–µ–ª–æ–∫
5. ‚úÖ –£–ª—É—á—à–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Å –∫–∞–∂–¥–æ–π —Å–¥–µ–ª–∫–æ–π

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ML –º–æ–¥–µ–ª–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —É–º–Ω–µ–µ –∏ —Ç–æ—á–Ω–µ–µ —Å –∫–∞–∂–¥—ã–º –¥–Ω–µ–º! üß†üìà
